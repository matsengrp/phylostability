data_folder="data"
num_samples=4

rule all:
    input:
        data_folder+"/selected_data/plots/random_forest_results.pdf"

# save num_taxa and num_sequences for every nexus or fasta file in a subdirectory of data_folder
rule get_nexus_data:
    input:
        data=data_folder
    output:
        data_folder+"/nexus_data.csv"
    shell:
        "./scripts/get_nexus_data.sh  {input.data}"

rule select_datasets:
    input:
        data_csv=data_folder+"/nexus_data.csv",
    params:
        num_samples=num_samples,
        data=data_folder
    output:
        temp(touch(data_folder+"/select_datasets.done")),
        data_folder+"/selected_datasets.csv",
    script:
        "scripts/select_datasets.py"

rule run_stability_analysis:
    input:
        data_folder+"/select_datasets.done",
    output:
        data_folder+"/selected_data/plots/random_forest_results.pdf"
    shell:
        '''
        snakemake -c8 --touch
        snakemake -c8 -n
        '''